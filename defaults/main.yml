---
# defaults file for mediapeers.clickhouse role

# Path settings:
clickhouse_path_logdir: /var/log/clickhouse-server
clickhouse_path_data:   /var/lib/clickhouse/
clickhouse_path_tmp:    /var/lib/clickhouse/tmp/

# Profiles
clickhouse_profiles:
 default:
   max_memory_usage: 10000000000
   use_uncompressed_cache: 0
   load_balancing: random
 readonly:
   readonly: 1

# Whitelisted network CIDRS:
# clickhouse_networks_default is defined in vars/main.yml
clickhouse_allowed_networks: "{{ clickhouse_networks_default }}"

# Listen address(es):
# Set this to 0.0.0.0 to listen on all IPv4 addresses and :: to listen on all IPv6 and IPv4 networks
clickhouse_listen_hosts:
  - 127.0.0.1

# Ports
clickhouse_http_port: 8123
clickhouse_tcp_port: 9000
clickhouse_interserver_http_port: 9009

# Users and quotas:
clickhouse_users:
  - { name: "default", password: "", networks: "{{ clickhouse_allowed_networks }}", profile: "default", quota: "default", comment: "Default user for login if user not defined" }
  - { name: "readonly", password: "", networks: "{{ clickhouse_allowed_networks }}", profile: "default", quota: "default", comment: "Example of user with readonly access" }

clickhouse_quotas_intervals_default:
 - { duration: 3600, queries: 0, errors: 0, result_rows: 0, read_rows: 0, execution_time: 0 }

clickhouse_quotas:
 - { name: "default", intervals: "{{ clickhouse_quotas_intervals_default }}", comment: "Default quota - count only" }

# Zookeeper servers for clustering
clickhouse_zookeeper_servers: []
# Example list item:
# - { id: 1, hostname: 'node1.zookeeper.internal', client_port: 2181 }

# Remote clickhouse servers for data replication. Configs will can used in distributed tables.
clickhouse_cluster_configs: []
# Example list item:
#  - name: cluster_1
#    shards:
#      - replicas:
#        - { hostname: 'node01.clickhouse.servers', tcp_port: 9000 }
#        - { hostname: 'node02.clickhouse.servers', tcp_port: 9000 }
#      - replicas:
#        - { hostname: 'node11.clickhouse.servers', tcp_port: 9000 }
#        - { hostname: 'node12.clickhouse.servers', tcp_port: 9000 }

# Macro settings for clustering
clickhouse_shard_id: '01'
clickhouse_replica_id: '01'

# To add dbs and dicts during setup set those variables to lists:
# clickhouse_dbs: []
# clickhouse_dicts: []

# Logging:
clickhouse_logger:
  level: trace
  log: "{{ clickhouse_path_logdir }}/clickhouse-server.log"
  errorlog: "{{ clickhouse_path_logdir }}/clickhouse-server.err.log"
  size: 1000M
  count: 10

# Connection tuning:
clickhouse_config:
  max_connections: 4096
  keep_alive_timeout: 3
  max_concurrent_queries: 100
  uncompressed_cache_size: 8589934592
  mark_cache_size: 5368709120
  builtin_dictionaries_reload_interval: 3600
  max_session_timeout: 3600
  default_session_timeout: 60
